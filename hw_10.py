# -*- coding: utf-8 -*-
"""–î–ó10_–ö—Ä–∞–≤—á–µ–Ω–∫–æ –°–µ—Ä–≥—ñ–π.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1FDRQg42eGySw82d3kM5X5aYoY2ABDarb

##–ß–∞—Å—Ç–∏–Ω–∞ 1. –ê–Ω–∞–ª—ñ–∑ —Ç–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–∏—Ö

* –ü—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–π –¥—ñ–∞–ø–∞–∑–æ–Ω–∏ –∑–Ω–∞—á–µ–Ω—å, —ó—Ö —Å–µ—Ä–µ–¥–Ω—ñ —Ç–∞ –¥–∏—Å–ø–µ—Ä—Å—ñ—é, —Ä–æ–∑–ø–æ–¥—ñ–ª–∏,
–∫–æ—Ä–µ–ª—è—Ü—ñ—ó, –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –ø—Ä–æ–ø—É—â–µ–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å, —Ç–∏–ø–∏ –æ–∑–Ω–∞–∫.

* –ü–µ—Ä–µ–≤—ñ—Ä –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –ø—Ä–æ–ø—É—â–µ–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å. –ó–∞ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ –∑–∞–ø–æ–≤–Ω–∏ —ó—Ö –∞–±–æ –≤–∏–¥–∞–ª–∏ —Ä—è–¥–∫–∏ –∑ –ø—Ä–æ–ø—É—Å–∫–∞–º–∏.

* –ó–∞ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ –±—ñ–Ω–∞—Ä–Ω–∏—Ö –æ–∑–Ω–∞–∫ –∑–∞–º—ñ–Ω–∏ –∑–Ω–∞—á–µ–Ω–Ω—è —Ü–∏—Ö –æ–∑–Ω–∞–∫ –Ω–∞ 0 —Ç–∞ 1.

üëâüèº –ó–∞ –ø–æ—Ç—Ä–µ–±–∏ –ø–µ–≤–Ω—ñ –¥–∞–Ω—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–¥–∞–ª–µ–Ω–æ –∞–±–æ –º–æ–¥–∏—Ñ—ñ–∫–æ–≤–∞–Ω–æ.
"""

# –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏—Ö –±—ñ–±–ª—ñ–æ—Ç–µ–∫
!pip install xgboost
!ls /content/drive/MyDrive/datasets/

# –Ü–º–ø–æ—Ä—Ç—É—î–º–æ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from xgboost import XGBRegressor
from sklearn.metrics import r2_score, mean_absolute_error
from sklearn.model_selection import cross_val_score
from google.colab import drive
drive.mount('/content/drive')

# –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –¥–∞—Ç–∞—Å–µ—Ç
file_path = '/content/drive/MyDrive/datasets/House_Rent_Dataset.csv'
data = pd.read_csv(file_path)

# –í–∏–≤–µ–¥–µ–º–æ –ø–µ—Ä—à—ñ —Ä—è–¥–∫–∏ —Ç–∞ –∑–∞–≥–∞–ª—å–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –¥–∞–Ω—ñ
print("–ü–µ—Ä—à—ñ —Ä—è–¥–∫–∏ –¥–∞—Ç–∞—Å–µ—Ç—É:")
print(data.head())
print("\n–Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –¥–∞–Ω—ñ:")
print(data.info())

# 2. –ê–Ω–∞–ª—ñ–∑ –¥–∞–Ω–∏—Ö
# –û–ø–∏—Å–æ–≤–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
print("\n–û–ø–∏—Å–æ–≤–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —á–∏—Å–ª–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö:")
print(data.describe())

# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å
print("\n–ü—Ä–æ–ø—É—â–µ–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –≤ –∫–æ–∂–Ω–æ–º—É —Å—Ç–æ–≤–ø—Ü—ñ:")
print(data.isnull().sum())

# –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è —Ä–æ–∑–ø–æ–¥—ñ–ª—É —á–∏—Å–ª–æ–≤–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö
data.hist(figsize=(15, 10), bins=30, edgecolor='k')
plt.suptitle("–†–æ–∑–ø–æ–¥—ñ–ª —á–∏—Å–ª–æ–≤–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö", fontsize=16)
plt.show()

# –§–æ—Ä–º—É—î–º–æ –∫–æ—Ä–µ–ª—è—Ü—ñ–π–Ω—É –º–∞—Ç—Ä–∏—Ü—é –¥–ª—è —á–∏—Å–ª–æ–≤–∏—Ö —Å—Ç–æ–≤–ø—Ü—ñ–≤
data_numeric = data.select_dtypes(include=[np.number])
corr_matrix = data_numeric.corr()

# –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è –∫–æ—Ä–µ–ª—è—Ü—ñ–π–Ω–æ—ó –º–∞—Ç—Ä–∏—Ü—ñ
print("\n–ö–æ—Ä–µ–ª—è—Ü—ñ–π–Ω–∞ –º–∞—Ç—Ä–∏—Ü—è:")
sns.heatmap(corr_matrix, annot=True, cmap='coolwarm', fmt=".2f")
plt.title("–ö–æ—Ä–µ–ª—è—Ü—ñ–π–Ω–∞ –º–∞—Ç—Ä–∏—Ü—è")
plt.show()

# –í–∏–¥–∞–ª—è—î–º–æ –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ñ –∞–±–æ –Ω–µ—á–∏—Å–ª–æ–≤—ñ —Å—Ç–æ–≤–ø—Ü—ñ
data_cleaned = data.drop(columns=['Posted On', 'Area Locality'])

# One-hot encoding –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä—ñ–∞–ª—å–Ω–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö
data_cleaned = pd.get_dummies(data_cleaned, drop_first=True)

# –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –¥–∞–Ω—ñ –ø—ñ—Å–ª—è –æ–±—Ä–æ–±–∫–∏
print("\n–û–Ω–æ–≤–ª–µ–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –¥–∞–Ω—ñ:")
print(data_cleaned.info())

"""**–ü–æ—è—Å–Ω–µ–Ω–Ω—è**:

### –ê–Ω–∞–ª—ñ–∑ –¥–∞–Ω–∏—Ö
1. **–ê–Ω–∞–ª—ñ–∑ –¥—ñ–∞–ø–∞–∑–æ–Ω—ñ–≤ –∑–Ω–∞—á–µ–Ω—å, —Å–µ—Ä–µ–¥–Ω—ñ—Ö —Ç–∞ –¥–∏—Å–ø–µ—Ä—Å—ñ–π**:  
   - –î–ª—è —Ä–æ–∑—É–º—ñ–Ω–Ω—è —Ä–æ–∑–ø–æ–¥—ñ–ª—É —á–∏—Å–ª–æ–≤–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö –±—É–ª–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –º–µ—Ç–æ–¥ **`describe()`**.  
   - –¶–µ –¥–æ–∑–≤–æ–ª–∏–ª–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ –æ—Å–Ω–æ–≤–Ω—ñ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω—ñ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏: **—Å–µ—Ä–µ–¥–Ω—î –∑–Ω–∞—á–µ–Ω–Ω—è, –º–µ–¥—ñ–∞–Ω—É, –º—ñ–Ω—ñ–º—É–º, –º–∞–∫—Å–∏–º—É–º, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–µ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è —Ç–∞ –¥—ñ–∞–ø–∞–∑–æ–Ω –∑–Ω–∞—á–µ–Ω—å**.  
   - –û—Å–Ω–æ–≤–Ω—ñ –ø–æ–∫–∞–∑–Ω–∏–∫–∏ –¥–æ–∑–≤–æ–ª–∏–ª–∏ –æ—Ü—ñ–Ω–∏—Ç–∏ –¥—ñ–∞–ø–∞–∑–æ–Ω–∏ –∑–º—ñ–Ω–∏ –≤–µ–ª–∏—á–∏–Ω —Ç–∞–∫–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö, —è–∫ `Rent`, `Size`, `BHK` —Ç–∞ `Bathroom`.

2. **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –ø—Ä–æ–ø—É—â–µ–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å**:  
   - –ë—É–ª–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –º–µ—Ç–æ–¥ **`isnull().sum()`**, —è–∫–∏–π –ø–æ–∫–∞–∑—É—î –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–æ–ø—É—Å–∫—ñ–≤ —É –∫–æ–∂–Ω–æ–º—É —Å—Ç–æ–≤–ø—Ü—ñ.  
   - –£ –Ω–∞—à–æ–º—É –¥–∞—Ç–∞—Å–µ—Ç—ñ –≤—ñ–¥—Å—É—Ç–Ω—ñ –ø—Ä–æ–ø—É—â–µ–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è, —Ç–æ–º—É –¥–æ–¥–∞—Ç–∫–æ–≤–µ –∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è —á–∏ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –Ω–µ –∑–Ω–∞–¥–æ–±–∏–ª–æ—Å—è.

3. **–ê–Ω–∞–ª—ñ–∑ –∫–æ—Ä–µ–ª—è—Ü—ñ–π –º—ñ–∂ —á–∏—Å–ª–æ–≤–∏–º–∏ –æ–∑–Ω–∞–∫–∞–º–∏**:  
   - –î–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è –∑–≤'—è–∑–∫—ñ–≤ –º—ñ–∂ —á–∏—Å–ª–æ–≤–∏–º–∏ –∑–º—ñ–Ω–Ω–∏–º–∏ –±—É–ª–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –º–µ—Ç–æ–¥ **`corr()`**.  
   - –ö–æ—Ä–µ–ª—è—Ü—ñ–π–Ω–∞ –º–∞—Ç—Ä–∏—Ü—è –¥–æ–∑–≤–æ–ª–∏–ª–∞ –∑–Ω–∞–π—Ç–∏ –æ–∑–Ω–∞–∫–∏, —è–∫—ñ –Ω–∞–π–±—ñ–ª—å—à–µ –≤–ø–ª–∏–≤–∞—é—Ç—å –Ω–∞ —Ü—ñ–ª—å–æ–≤—É –∑–º—ñ–Ω–Ω—É `Rent`.  
   - –î–ª—è –Ω–∞–æ—á–Ω–æ—Å—Ç—ñ –±—É–ª–æ –ø–æ–±—É–¥–æ–≤–∞–Ω–æ **—Ç–µ–ø–ª–æ–≤—É –∫–∞—Ä—Ç—É** –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ **Seaborn** (**`sns.heatmap()`**).  
  - –ó–Ω–∞–π–¥–µ–Ω–æ –≤–∏—Å–æ–∫—É –∫–æ—Ä–µ–ª—è—Ü—ñ—é –º—ñ–∂ –æ–∑–Ω–∞–∫–∞–º–∏ `Size`, `Bathroom` —Ç–∞ `BHK`.

---

### –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–∏—Ö
1. **–í–∏–¥–∞–ª–µ–Ω–Ω—è –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–∏—Ö –æ–∑–Ω–∞–∫**:  
   - –û–∑–Ω–∞–∫–∏, —â–æ –Ω–µ –Ω–µ—Å—É—Ç—å –∑–Ω–∞—á–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –¥–ª—è –º–æ–¥–µ–ª—é–≤–∞–Ω–Ω—è (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, **`Posted On`** —ñ **`Area Locality`**), –±—É–ª–∏ –≤–∏–¥–∞–ª–µ–Ω—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **`drop()`**.  
   - –¶–µ –∑–º–µ–Ω—à–∏–ª–æ —Ä–æ–∑–º—ñ—Ä–Ω—ñ—Å—Ç—å –¥–∞–Ω–∏—Ö —ñ –∑–æ—Å–µ—Ä–µ–¥–∏–ª–æ —É–≤–∞–≥—É –Ω–∞ –±—ñ–ª—å—à –≤–∞–∂–ª–∏–≤–∏—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞—Ö.

2. **–û–±—Ä–æ–±–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ–∞–ª—å–Ω–∏—Ö –æ–∑–Ω–∞–∫**:  
   - –î–ª—è —Ä–æ–±–æ—Ç–∏ –∑ —Ç–µ–∫—Å—Ç–æ–≤–∏–º–∏ –∑–º—ñ–Ω–Ω–∏–º–∏, —Ç–∞–∫–∏–º–∏ —è–∫ `City`, `Furnishing Status` —Ç–∞ `Area Type`, –±—É–ª–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –º–µ—Ç–æ–¥ **`pd.get_dummies()`** (one-hot encoding).  
   - –¶–µ –¥–æ–∑–≤–æ–ª–∏–ª–æ –ø–µ—Ä–µ—Ç–≤–æ—Ä–∏—Ç–∏ –∫–∞—Ç–µ–≥–æ—Ä—ñ–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ –Ω–∞ —á–∏—Å–ª–æ–≤—ñ, —Å—Ç–≤–æ—Ä–∏–≤—à–∏ –Ω–æ–≤—ñ –±—ñ–Ω–∞—Ä–Ω—ñ –æ–∑–Ω–∞–∫–∏.  
   - –î–ª—è —É–Ω–∏–∫–Ω–µ–Ω–Ω—è –º—É–ª—å—Ç–∏–∫–æ–ª—ñ–Ω–µ–∞—Ä–Ω–æ—Å—Ç—ñ –±—É–ª–æ –≤–∫–∞–∑–∞–Ω–æ –ø–∞—Ä–∞–º–µ—Ç—Ä **`drop_first=True`**, —â–æ –≤–∏–¥–∞–ª—è—î –æ–¥–Ω—É –∑ –∫–∞—Ç–µ–≥–æ—Ä—ñ–π.

3. **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω–∏—Ö –¥–∞–Ω–∏—Ö**:  
   - –ü—ñ—Å–ª—è –æ–±—Ä–æ–±–∫–∏ –¥–∞–Ω–∏—Ö –º–µ—Ç–æ–¥ **`info()`** –±—É–≤ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ç–∏–ø—ñ–≤ –æ–∑–Ω–∞–∫ —Ç–∞ –æ–Ω–æ–≤–ª–µ–Ω–æ—ó —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –¥–∞—Ç–∞—Å–µ—Ç—É.  
   - –ë—É–ª–æ —Å—Ñ–æ—Ä–º–æ–≤–∞–Ω–æ –æ—Å—Ç–∞—Ç–æ—á–Ω–∏–π –¥–∞—Ç–∞—Å–µ—Ç —ñ–∑ —á–∏—Å–ª–æ–≤–∏–º–∏ —Ç–∞ –±—ñ–Ω–∞—Ä–Ω–∏–º–∏ –æ–∑–Ω–∞–∫–∞–º–∏ –¥–ª—è –ø–æ–¥–∞–ª—å—à–æ–≥–æ –º–æ–¥–µ–ª—é–≤–∞–Ω–Ω—è.

---

### **–ö–æ—Ä–æ—Ç–∫–µ –ø—ñ–¥—Å—É–º—É–≤–∞–Ω–Ω—è**
- **–ú–µ—Ç–æ–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ**: `describe()`, `isnull().sum()`, `corr()`, `drop()`, `pd.get_dummies()`.
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ü—ñ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–æ —á–∏—Å—Ç–∏–π, —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–∏–π –Ω–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö —ñ–∑ —á–∏—Å–ª–æ–≤–∏–º–∏ –æ–∑–Ω–∞–∫–∞–º–∏, –≥–æ—Ç–æ–≤–∏–π –¥–ª—è –ø–æ–±—É–¥–æ–≤–∏ –º–æ–¥–µ–ª–µ–π.

##–ß–∞—Å—Ç–∏–Ω–∞ 2. –ú–æ–¥–µ–ª—é–≤–∞–Ω–Ω—è

* –°—Ç–≤–æ—Ä–∏ —è–∫ –º—ñ–Ω—ñ–º—É–º 2 —Ä—ñ–∑–Ω—ñ —Ä–µ–≥—Ä–µ—Å—ñ–π–Ω—ñ –º–æ–¥–µ–ª—ñ –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è —Ü—ñ–ª—å–æ–≤–æ—ó –∑–º—ñ–Ω–Ω–æ—ó ‚ÄúRent‚Äù.

üëâüèº –ú–æ–¥–µ–ª—ñ –≤–≤–∞–∂–∞—é—Ç—å—Å—è —Ä—ñ–∑–Ω–∏–º–∏, —è–∫—â–æ –≤–æ–Ω–∏ –±–∞–∑—É—é—Ç—å—Å—è –Ω–∞ —Ä—ñ–∑–Ω–∏—Ö –¥–∞–Ω–∏—Ö –∞–±–æ —î —Ä—ñ–∑–Ω–∏–º–∏ —Ç–∏–ø–∞–º–∏ –º–æ–¥–µ–ª–µ–π.

* –û—Ü—ñ–Ω–∏ —è–∫—ñ—Å—Ç—å –º–æ–¥–µ–ª–µ–π —è–∫ –º—ñ–Ω—ñ–º—É–º –∑–∞ 2 –º–µ—Ç—Ä–∏–∫–∞–º–∏.

üëâüèº –û—Ü—ñ–Ω–∫–∞ –º–∞—î –±—É—Ç–∏ –ø—Ä–æ–≤–µ–¥–µ–Ω–∞ –∞–±–æ –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ñ–π –≤–∏–±—ñ—Ä—Ü—ñ, –∞–±–æ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫—Ä–æ—Å-–≤–∞–ª—ñ–¥–∞—Ü—ñ—ó.
"""

# 4. –†–æ–∑–ø–æ–¥—ñ–ª –¥–∞–Ω–∏—Ö –Ω–∞ –æ–∑–Ω–∞–∫–∏ —Ç–∞ —Ü—ñ–ª—å–æ–≤—É –∑–º—ñ–Ω–Ω—É
# --------------------------------------------------------------------------
# –í–∏–±–∏—Ä–∞—î–º–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ñ –æ–∑–Ω–∞–∫–∏
important_features = ['BHK', 'Size', 'Bathroom', 'City_Mumbai', 'City_Chennai',
                      'Furnishing Status_Unfurnished', 'Area Type_Super Area']
target = 'Rent'

# –°—Ç–≤–æ—Ä—é—î–º–æ —Å–∫–æ—Ä–æ—á–µ–Ω–∏–π –¥–∞—Ç–∞—Å–µ—Ç
data_reduced = data_cleaned[important_features + [target]]

# –†–æ–∑–ø–æ–¥—ñ–ª –Ω–∞ –æ–∑–Ω–∞–∫–∏ (X) —Ç–∞ —Ü—ñ–ª—å–æ–≤—É –∑–º—ñ–Ω–Ω—É (y)
X = data_reduced.drop(columns=[target])
y = data_reduced[target]

# –ü–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –¥–∞—Ç–∏ —É —á–∏—Å–ª–æ–≤–∏–π —Ñ–æ—Ä–º–∞—Ç, —è–∫—â–æ —Ü–µ–π —Å—Ç–æ–≤–ø–µ—Ü—å –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏–π
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# 5. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞ –æ—Ü—ñ–Ω–∫–∞ –º–æ–¥–µ–ª–µ–π
# --------------------------------------------------------------------------
# –õ—ñ–Ω—ñ–π–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è
model_lr = LinearRegression()
model_lr.fit(X_train, y_train)
y_pred_lr = model_lr.predict(X_test)

# –ì—Ä–∞–¥—ñ—î–Ω—Ç–Ω–∏–π –±—É—Å—Ç–∏–Ω–≥ (XGBoost)
model_xgb = XGBRegressor(random_state=42)
model_xgb.fit(X_train, y_train)
y_pred_xgb = model_xgb.predict(X_test)

# –û—Ü—ñ–Ω–∫–∞ –º–æ–¥–µ–ª–µ–π
r2_lr = r2_score(y_test, y_pred_lr)
mae_lr = mean_absolute_error(y_test, y_pred_lr)

r2_xgb = r2_score(y_test, y_pred_xgb)
mae_xgb = mean_absolute_error(y_test, y_pred_xgb)

print(f"\n–õ—ñ–Ω—ñ–π–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è: R¬≤ = {r2_lr:.2f}, MAE = {mae_lr:.2f}")
print(f"–ì—Ä–∞–¥—ñ—î–Ω—Ç–Ω–∏–π –±—É—Å—Ç–∏–Ω–≥: R¬≤ = {r2_xgb:.2f}, MAE = {mae_xgb:.2f}")

# –ö—Ä–æ—Å-–≤–∞–ª—ñ–¥–∞—Ü—ñ—è –¥–ª—è –õ—ñ–Ω—ñ–π–Ω–æ—ó —Ä–µ–≥—Ä–µ—Å—ñ—ó
cv_scores_lr = cross_val_score(model_lr, X, y, cv=5, scoring='neg_mean_absolute_error')
print(f"–°–µ—Ä–µ–¥–Ω—ñ–π MAE (–õ—ñ–Ω—ñ–π–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è): {-cv_scores_lr.mean():.2f}")

# –ö—Ä–æ—Å-–≤–∞–ª—ñ–¥–∞—Ü—ñ—è –¥–ª—è –ì—Ä–∞–¥—ñ—î–Ω—Ç–Ω–æ–≥–æ –±—É—Å—Ç–∏–Ω–≥—É
cv_scores_xgb = cross_val_score(model_xgb, X, y, cv=5, scoring='neg_mean_absolute_error')
print(f"–°–µ—Ä–µ–¥–Ω—ñ–π MAE (–ì—Ä–∞–¥—ñ—î–Ω—Ç–Ω–∏–π –±—É—Å—Ç–∏–Ω–≥): {-cv_scores_xgb.mean():.2f}")

"""**–ü–æ—è—Å–Ω–µ–Ω–Ω—è**:

### –ú–æ–¥–µ–ª—é–≤–∞–Ω–Ω—è

- **–û–∑–Ω–∞–∫–∏ —Ç–∞ —Ü—ñ–ª—å–æ–≤–∞ –∑–º—ñ–Ω–Ω–∞**:
   - **–û–∑–Ω–∞–∫–∏**: `BHK`, `Size`, `Bathroom`, `City_Mumbai`, `City_Chennai`, `Furnishing Status_Unfurnished`, `Area Type_Super Area`.  
     –¶—ñ –æ–∑–Ω–∞–∫–∏ —î **—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–∏–º–∏**, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–æ–Ω–∏ –æ–ø–∏—Å—É—é—Ç—å –∂–∏—Ç–ª–æ (–∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫—ñ–º–Ω–∞—Ç, –ø–ª–æ—â–∞, —Ç–∏–ø –º—ñ—Å—Ü—è —Ä–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è —Ç–æ—â–æ).  
   - **–¶—ñ–ª—å–æ–≤–∞ –∑–º—ñ–Ω–Ω–∞**: `Rent` (–æ—Ä–µ–Ω–¥–Ω–∞ –ø–ª–∞—Ç–∞).  

- **–†–æ–∑–¥—ñ–ª–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö**:
   - –î–∞–Ω—ñ —Ä–æ–∑–¥—ñ–ª–µ–Ω–æ –Ω–∞ **–Ω–∞–≤—á–∞–ª—å–Ω—É (80%)** —ñ **—Ç–µ—Å—Ç–æ–≤—É (20%)** –≤–∏–±—ñ—Ä–∫–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `train_test_split()`.

- **–ü–æ–±—É–¥–æ–≤–∞ –º–æ–¥–µ–ª–µ–π**:
   1. **–õ—ñ–Ω—ñ–π–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è**:
      - –ü—Ä–æ—Å—Ç–∞, —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–æ–≤–∞–Ω–∞ –º–æ–¥–µ–ª—å, —â–æ –ø—Ä–∏–ø—É—Å–∫–∞—î –ª—ñ–Ω—ñ–π–Ω–∏–π –∑–≤'—è–∑–æ–∫ –º—ñ–∂ –æ–∑–Ω–∞–∫–∞–º–∏ —Ç–∞ —Ü—ñ–ª—å–æ–≤–æ—é –∑–º—ñ–Ω–Ω–æ—é.
   2. **–ì—Ä–∞–¥—ñ—î–Ω—Ç–Ω–∏–π –±—É—Å—Ç–∏–Ω–≥ (XGBoost)**:
      - –°—É—á–∞—Å–Ω–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º, —â–æ –æ–±—Ä–æ–±–ª—è—î **–Ω–µ–ª—ñ–Ω—ñ–π–Ω—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ** —ñ –¥–æ–±—Ä–µ –ø—Ä–∞—Ü—é—î –∑ –≤–µ–ª–∏–∫–∏–º–∏ –¥–∞–Ω–∏–º–∏.

- **–ú–µ—Ç—Ä–∏–∫–∏ –æ—Ü—ñ–Ω–∫–∏**:
   - **\( R^2 \)** (–∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –¥–µ—Ç–µ—Ä–º—ñ–Ω–∞—Ü—ñ—ó): –ø–æ–∫–∞–∑—É—î, –Ω–∞—Å–∫—ñ–ª—å–∫–∏ –¥–æ–±—Ä–µ –º–æ–¥–µ–ª—å –ø–æ—è—Å–Ω—é—î –≤–∞—Ä—ñ–∞—Ü—ñ—é —Ü—ñ–ª—å–æ–≤–æ—ó –∑–º—ñ–Ω–Ω–æ—ó.  
   - **MAE** (—Å–µ—Ä–µ–¥–Ω—è –∞–±—Å–æ–ª—é—Ç–Ω–∞ –ø–æ–º–∏–ª–∫–∞): –ø–æ–∫–∞–∑—É—î —Å–µ—Ä–µ–¥–Ω—î –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è –ø—Ä–æ–≥–Ω–æ–∑—ñ–≤ –≤—ñ–¥ —Ä–µ–∞–ª—å–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å.  
   - **–ö—Ä–æ—Å-–≤–∞–ª—ñ–¥–∞—Ü—ñ—è**: –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞–±—ñ–ª—å–Ω–æ—Å—Ç—ñ –º–æ–¥–µ–ª–µ–π –Ω–∞ 5 —Ñ–æ–ª–¥–∞—Ö.

---

#### **2. –û—Ç—Ä–∏–º–∞–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏**
| –ú–æ–¥–µ–ª—å                 | \( R^2 \)   | MAE (—Ç–µ—Å—Ç) | –°–µ—Ä–µ–¥–Ω—ñ–π MAE (–∫—Ä–æ—Å-–≤–∞–ª—ñ–¥–∞—Ü—ñ—è) |
|------------------------|------------|------------|-------------------------------|
| **–õ—ñ–Ω—ñ–π–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è**   | 0.51       | 22842.34   | 26599.26                     |
| **–ì—Ä–∞–¥—ñ—î–Ω—Ç–Ω–∏–π –±—É—Å—Ç–∏–Ω–≥**| 0.28       | 15332.07   | 15000.63                     |

---

#### **3. –ê–Ω–∞–ª—ñ–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤**

1. **–õ—ñ–Ω—ñ–π–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è**:
   - **\( R^2 = 0.51 \)**: –º–æ–¥–µ–ª—å –ø–æ—è—Å–Ω—é—î –ª–∏—à–µ **51% –≤–∞—Ä—ñ–∞—Ü—ñ—ó** —Ü—ñ–ª—å–æ–≤–æ—ó –∑–º—ñ–Ω–Ω–æ—ó.  
   - **MAE = 22842.34**: —Å–µ—Ä–µ–¥–Ω—è –ø–æ–º–∏–ª–∫–∞ –¥–æ—Å–∏—Ç—å –≤–µ–ª–∏–∫–∞, —â–æ –≤–∫–∞–∑—É—î –Ω–∞ –ø–æ–≥–∞–Ω—É —Ç–æ—á–Ω—ñ—Å—Ç—å –¥–ª—è –æ–∫—Ä–µ–º–∏—Ö –∑–Ω–∞—á–µ–Ω—å –æ—Ä–µ–Ω–¥–∏.  
   - **–°–µ—Ä–µ–¥–Ω—ñ–π MAE –Ω–∞ –∫—Ä–æ—Å-–≤–∞–ª—ñ–¥–∞—Ü—ñ—ó = 26599.26**: —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—î –Ω–µ—Å—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å –º–æ–¥–µ–ª—ñ.

   **–í–∏—Å–Ω–æ–≤–æ–∫**: –õ—ñ–Ω—ñ–π–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è –Ω–µ –∑–¥–∞—Ç–Ω–∞ —Ç–æ—á–Ω–æ –º–æ–¥–µ–ª—é–≤–∞—Ç–∏ –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å —á–µ—Ä–µ–∑ **–Ω–µ–ª—ñ–Ω—ñ–π–Ω—ñ—Å—Ç—å –¥–∞–Ω–∏—Ö**.

2. **–ì—Ä–∞–¥—ñ—î–Ω—Ç–Ω–∏–π –±—É—Å—Ç–∏–Ω–≥ (XGBoost)**:
   - **\( R^2 = 0.28 \)**: –º–æ–¥–µ–ª—å –ø–æ—è—Å–Ω—é—î –ª–∏—à–µ **28% –≤–∞—Ä—ñ–∞—Ü—ñ—ó** —Ü—ñ–ª—å–æ–≤–æ—ó –∑–º—ñ–Ω–Ω–æ—ó, —â–æ —î –¥—É–∂–µ –Ω–∏–∑—å–∫–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –¥–ª—è —Ü—ñ—î—ó –º–æ–¥–µ–ª—ñ.
   - **MAE = 15332.07**: –ø–æ–º–∏–ª–∫–∞ –º–µ–Ω—à–∞, –Ω—ñ–∂ —É –ª—ñ–Ω—ñ–π–Ω–æ—ó —Ä–µ–≥—Ä–µ—Å—ñ—ó, —â–æ —Å–≤—ñ–¥—á–∏—Ç—å –ø—Ä–æ **–∫—Ä–∞—â—É —Ç–æ—á–Ω—ñ—Å—Ç—å –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è**.  
   - **–°–µ—Ä–µ–¥–Ω—ñ–π MAE –Ω–∞ –∫—Ä–æ—Å-–≤–∞–ª—ñ–¥–∞—Ü—ñ—ó = 15000.63**: –∫—Ä–æ—Å-–≤–∞–ª—ñ–¥–∞—Ü—ñ—è –ø–æ–∫–∞–∑—É—î —Å—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å —Ä–æ–±–æ—Ç–∏ –º–æ–¥–µ–ª—ñ.  

   **–í–∏—Å–Ω–æ–≤–æ–∫**: –ù–µ–∑–≤–∞–∂–∞—é—á–∏ –Ω–∞ –Ω–∏–∑—å–∫–µ \( R^2 \), XGBoost –ø–æ–∫–∞–∑—É—î **–º–µ–Ω—à—É –ø–æ–º–∏–ª–∫—É** —Ç–∞ –∫—Ä–∞—â—É —Å—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å –ø–æ—Ä—ñ–≤–Ω—è–Ω–æ –∑ –ª—ñ–Ω—ñ–π–Ω–æ—é —Ä–µ–≥—Ä–µ—Å—ñ—î—é.  
---


1. **–ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –º–æ–¥–µ–ª–µ–π**:
   - –õ—ñ–Ω—ñ–π–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è –º–∞—î **–∫—Ä–∞—â–∏–π \( R^2 \)** (0.51), –∞–ª–µ **–≤–∏—Å–æ–∫–∏–π MAE** –≤–∫–∞–∑—É—î –Ω–∞ –≤–µ–ª–∏–∫—ñ –ø–æ–º–∏–ª–∫–∏.
   - XGBoost –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î **–Ω–∏–∂—á–∏–π \( R^2 \)** (0.28), –∞–ª–µ **–º–µ–Ω—à–∏–π MAE**, —â–æ —Å–≤—ñ–¥—á–∏—Ç—å –ø—Ä–æ –∫—Ä–∞—â—É —Ç–æ—á–Ω—ñ—Å—Ç—å –ø—Ä–æ–≥–Ω–æ–∑—ñ–≤ –¥–ª—è —Ç–∏–ø–æ–≤–∏—Ö –∑–Ω–∞—á–µ–Ω—å.

2. **–û—Å–Ω–æ–≤–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏**:
   - –ù–∞—è–≤–Ω—ñ—Å—Ç—å **–∞–Ω–æ–º–∞–ª—å–Ω–æ –≤–µ–ª–∏–∫–∏—Ö –∑–Ω–∞—á–µ–Ω—å** —É –¥–∞–Ω–∏—Ö.
   - –ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—è –∫—ñ–ª—å–∫—ñ—Å—Ç—å –æ–∑–Ω–∞–∫ –¥–ª—è –ø–æ—è—Å–Ω–µ–Ω–Ω—è –≤–∞—Ä—ñ–∞—Ü—ñ—ó –æ—Ä–µ–Ω–¥–Ω–æ—ó –ø–ª–∞—Ç–∏.
**–ü—ñ–¥—Å—É–º–æ–∫**: –û–±–∏–¥–≤—ñ –º–æ–¥–µ–ª—ñ –ø–æ–∫–∞–∑—É—é—Ç—å –æ–±–º–µ–∂–µ–Ω—É –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å —á–µ—Ä–µ–∑ –Ω–µ—Å—Ç–∞–±—ñ–ª—å–Ω—ñ –¥–∞–Ω—ñ. –î–ª—è –ø—ñ–¥–≤–∏—â–µ–Ω–Ω—è —Ç–æ—á–Ω–æ—Å—Ç—ñ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ **–ø–æ–∫—Ä–∞—â–∏—Ç–∏ —è–∫—ñ—Å—Ç—å –¥–∞–Ω–∏—Ö** —Ç–∞ –¥–æ–¥–∞—Ç–∏ –Ω–æ–≤—ñ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ñ –æ–∑–Ω–∞–∫–∏.

##–ß–∞—Å—Ç–∏–Ω–∞ 3. –ê–Ω–∞–ª—ñ–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤

* –î–ª—è –≤—Å—ñ—Ö –º–æ–¥–µ–ª–µ–π –ø–æ–±—É–¥—É–π –≥—Ä–∞—Ñ—ñ–∫–∏ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è —Å–ø—Ä–∞–≤–∂–Ω—ñ—Ö —Ç–∞ —Å–ø—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω–∏—Ö –¥–∞–Ω–∏—Ö.
* –ó—Ä–æ–±–∏ –≤–∏—Å–Ω–æ–≤–∫–∏, –Ω–∞ —è–∫–∏—Ö –ø—Ä–∏–∫–ª–∞–¥–∞—Ö –∫–æ–∂–Ω–∞ –º–æ–¥–µ–ª—å –±—ñ–ª—å—à–µ –ø–æ–º–∏–ª—è—î—Ç—å—Å—è.
* –ó—Ä–æ–±–∏ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è —è–∫–æ—Å—Ç—ñ –º–æ–¥–µ–ª–µ–π. –ù–∞–ø–∏—à–∏ –≤–∏—Å–Ω–æ–≤–∫–∏.
"""

# 6. –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
# --------------------------------------------------------------------------
# –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è —Å–ø—Ä–∞–≤–∂–Ω—ñ—Ö —Ç–∞ —Å–ø—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å
def plot_actual_vs_predicted(y_test, y_pred, model_name):
    plt.figure(figsize=(8, 6))
    plt.scatter(y_test, y_pred, alpha=0.6)
    plt.plot([y_test.min(), y_test.max()], [y_test.min(), y_test.max()], 'r--', lw=2)
    plt.title(f"–°–ø—Ä–∞–≤–∂–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è vs –ü—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω—ñ ({model_name})")
    plt.xlabel("–°–ø—Ä–∞–≤–∂–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è")
    plt.ylabel("–ü—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è")
    plt.show()

plot_actual_vs_predicted(y_test, y_pred_lr, "–õ—ñ–Ω—ñ–π–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è")
plot_actual_vs_predicted(y_test, y_pred_xgb, "–ì—Ä–∞–¥—ñ—î–Ω—Ç–Ω–∏–π –±—É—Å—Ç–∏–Ω–≥")

# –ì—ñ—Å—Ç–æ–≥—Ä–∞–º–∞ –ø–æ–º–∏–ª–æ–∫
errors_lr = abs(y_test - y_pred_lr)
errors_xgb = abs(y_test - y_pred_xgb)

# –ó–Ω–∞—Ö–æ–¥–∏–º–æ —Ç–æ–ø-5 –Ω–∞–π–±—ñ–ª—å—à–∏—Ö –ø–æ–º–∏–ª–æ–∫ –¥–ª—è –æ–±–æ—Ö –º–æ–¥–µ–ª–µ–π
largest_errors_lr = errors_lr.nlargest(5)
largest_errors_xgb = errors_xgb.nlargest(5)

print("\n–¢–æ–ø-5 –Ω–∞–π–±—ñ–ª—å—à–∏—Ö –ø–æ–º–∏–ª–æ–∫ (–õ—ñ–Ω—ñ–π–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è):")
print(largest_errors_lr)

print("\n–¢–æ–ø-5 –Ω–∞–π–±—ñ–ª—å—à–∏—Ö –ø–æ–º–∏–ª–æ–∫ (–ì—Ä–∞–¥—ñ—î–Ω—Ç–Ω–∏–π –±—É—Å—Ç–∏–Ω–≥):")
print(largest_errors_xgb)

plt.figure(figsize=(10, 5))
plt.hist(errors_lr, bins=30, alpha=0.6, label='–õ—ñ–Ω—ñ–π–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è')
plt.hist(errors_xgb, bins=30, alpha=0.6, label='–ì—Ä–∞–¥—ñ—î–Ω—Ç–Ω–∏–π –±—É—Å—Ç–∏–Ω–≥')
plt.title("–ì—ñ—Å—Ç–æ–≥—Ä–∞–º–∞ –ø–æ–º–∏–ª–æ–∫")
plt.xlabel("–ê–±—Å–æ–ª—é—Ç–Ω–∞ –ø–æ–º–∏–ª–∫–∞")
plt.ylabel("–ß–∞—Å—Ç–æ—Ç–∞")
plt.legend()
plt.show()

# 7. –í–∏—Å–Ω–æ–≤–∫–∏
# --------------------------------------------------------------------------
print("\n–í–∏—Å–Ω–æ–≤–∫–∏:")
print("- –õ—ñ–Ω—ñ–π–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î –±–∞–∑–æ–≤—É —Ç–æ—á–Ω—ñ—Å—Ç—å, –∞–ª–µ –Ω–µ –≤—Ä–∞—Ö–æ–≤—É—î –Ω–µ–ª—ñ–Ω—ñ–π–Ω—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ.")
print("- –ì—Ä–∞–¥—ñ—î–Ω—Ç–Ω–∏–π –±—É—Å—Ç–∏–Ω–≥ –ø–æ–∫–∞–∑—É—î –∫—Ä–∞—â—É —Ç–æ—á–Ω—ñ—Å—Ç—å —ñ –º–µ–Ω—à—ñ –ø–æ–º–∏–ª–∫–∏, —â–æ —Ä–æ–±–∏—Ç—å –π–æ–≥–æ –∫—Ä–∞—â–∏–º –¥–ª—è —Ü—ñ—î—ó –∑–∞–¥–∞—á—ñ.")

"""### **–ß–∞—Å—Ç–∏–Ω–∞ 3: –ê–Ω–∞–ª—ñ–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤**

---

### **1. –ì—Ä–∞—Ñ—ñ–∫–∏ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è —Å–ø—Ä–∞–≤–∂–Ω—ñ—Ö —Ç–∞ —Å–ø—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å**

**–ú–µ—Ç–æ–¥**:  
–§—É–Ω–∫—Ü—ñ—è **`plot_actual_vs_predicted()`** –±—É–¥—É—î –≥—Ä–∞—Ñ—ñ–∫ —Ä–æ–∑—Å—ñ—é–≤–∞–Ω–Ω—è –¥–ª—è –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è **—Å–ø—Ä–∞–≤–∂–Ω—ñ—Ö –∑–Ω–∞—á–µ–Ω—å** —Ç–∞ **–ø—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å** –º–æ–¥–µ–ª—ñ.  

#### **–Ü–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—è –≥—Ä–∞—Ñ—ñ–∫—ñ–≤**:
1. **–õ—ñ–Ω—ñ–π–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è**:  
   - –ë—ñ–ª—å—à—ñ—Å—Ç—å —Ç–æ—á–æ–∫ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä—É—é—Ç—å—Å—è –±–ª–∏–∑—å–∫–æ –¥–æ –Ω–∏–∂–Ω—ñ—Ö –∑–Ω–∞—á–µ–Ω—å, –∞–ª–µ –±–∞–≥–∞—Ç–æ —Ç–æ—á–æ–∫ —Å–∏–ª—å–Ω–æ –≤—ñ–¥—Ö–∏–ª—è—é—Ç—å—Å—è –≤—ñ–¥ —á–µ—Ä–≤–æ–Ω–æ—ó –ª—ñ–Ω—ñ—ó —ñ–¥–µ–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ–≥–Ω–æ–∑—É.  
   - –õ—ñ–Ω—ñ–π–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è –ø–æ–≥–∞–Ω–æ –ø—Ä–æ–≥–Ω–æ–∑—É—î **–≤–∏—Å–æ–∫—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –æ—Ä–µ–Ω–¥–∏** —ñ –º–∞—î –≤–µ–ª–∏–∫—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ–º–∏–ª–æ–∫ –¥–ª—è –∞–Ω–æ–º–∞–ª—å–Ω–∏—Ö –≤–∏–ø–∞–¥–∫—ñ–≤.

2. **–ì—Ä–∞–¥—ñ—î–Ω—Ç–Ω–∏–π –±—É—Å—Ç–∏–Ω–≥ (XGBoost)**:  
   - –¢–æ—á–∫–∏ –∫—Ä–∞—â–µ –≥—Ä—É–ø—É—é—Ç—å—Å—è –Ω–∞–≤–∫–æ–ª–æ —á–µ—Ä–≤–æ–Ω–æ—ó –ª—ñ–Ω—ñ—ó, –∞–ª–µ –¥–ª—è –≤–∏—Å–æ–∫–∏—Ö –∑–Ω–∞—á–µ–Ω—å –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è —Ç–∞–∫–æ–∂ —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –∑–Ω–∞—á–Ω—ñ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è.  
   - XGBoost –ø—Ä–∞—Ü—é—î –∫—Ä–∞—â–µ –∑ **—Ç–∏–ø–æ–≤–∏–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏**, –∞–ª–µ –Ω–µ –ø–æ–≤–Ω—ñ—Å—Ç—é —Å–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è –∑ **–∞–Ω–æ–º–∞–ª—å–Ω–∏–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏** –æ—Ä–µ–Ω–¥–∏.

---

### **2. –ì—ñ—Å—Ç–æ–≥—Ä–∞–º–∞ –ø–æ–º–∏–ª–æ–∫**

**–ú–µ—Ç–æ–¥**:  
–ë—É–¥—É—î—Ç—å—Å—è –≥—ñ—Å—Ç–æ–≥—Ä–∞–º–∞ –ø–æ–º–∏–ª–æ–∫ –¥–ª—è –æ–±–æ—Ö –º–æ–¥–µ–ª–µ–π, –¥–µ –ø–æ–º–∏–ª–∫–∏ –æ–±—á–∏—Å–ª—é—é—Ç—å—Å—è —è–∫:  
$
\text{–ü–æ–º–∏–ª–∫–∞} = |y_{\text{test}} - y_{\text{predicted}}|
$

#### **–Ü–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—è –≥—ñ—Å—Ç–æ–≥—Ä–∞–º–∏**:
1. **–õ—ñ–Ω—ñ–π–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è**:
   - –ú–∞—î —à–∏—Ä—à–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª –ø–æ–º–∏–ª–æ–∫.  
   - –ë—ñ–ª—å—à–∞ —á–∞—Å—Ç–∏–Ω–∞ –ø–æ–º–∏–ª–æ–∫ –∑–Ω–∞—á–Ω–æ –ø–µ—Ä–µ–≤–∏—â—É—î —Å–µ—Ä–µ–¥–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è, —â–æ –≤–∫–∞–∑—É—î –Ω–∞ **–Ω–µ—Å—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å –º–æ–¥–µ–ª—ñ** –ø—Ä–∏ –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—ñ –æ—Ä–µ–Ω–¥–∏.

2. **–ì—Ä–∞–¥—ñ—î–Ω—Ç–Ω–∏–π –±—É—Å—Ç–∏–Ω–≥ (XGBoost)**:
   - –ü–æ–º–∏–ª–∫–∏ –º–∞—é—Ç—å **–±—ñ–ª—å—à –≤—É–∑—å–∫–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª**, —â–æ —Å–≤—ñ–¥—á–∏—Ç—å –ø—Ä–æ —Å—Ç–∞–±—ñ–ª—å–Ω—ñ—à–∏–π –ø—Ä–æ–≥–Ω–æ–∑ –¥–ª—è –±—ñ–ª—å—à–æ—Å—Ç—ñ –∑–Ω–∞—á–µ–Ω—å.  
   - –ë—ñ–ª—å—à—ñ—Å—Ç—å –ø–æ–º–∏–ª–æ–∫ –º–µ–Ω—à—ñ –∑–∞ –ø–æ–º–∏–ª–∫–∏ –ª—ñ–Ω—ñ–π–Ω–æ—ó —Ä–µ–≥—Ä–µ—Å—ñ—ó.

---

### **3. –ê–Ω–∞–ª—ñ–∑ –ø–æ–º–∏–ª–æ–∫ –Ω–∞ –ø—Ä–∏–∫–ª–∞–¥–∞—Ö**

**–ú–µ—Ç–æ–¥**:  
–í–∏–∑–Ω–∞—á–∞—î–º–æ —Ç–æ–ø-5 –Ω–∞–π–±—ñ–ª—å—à–∏—Ö –ø–æ–º–∏–ª–æ–∫ –¥–ª—è –∫–æ–∂–Ω–æ—ó –º–æ–¥–µ–ª—ñ, —â–æ–± –∑—Ä–æ–∑—É–º—ñ—Ç–∏, –Ω–∞ —è–∫–∏—Ö –ø—Ä–∏–∫–ª–∞–¥–∞—Ö –≤–æ–Ω–∏ –±—ñ–ª—å—à–µ –ø–æ–º–∏–ª—è—é—Ç—å—Å—è.

**–ö–æ–¥**:
```python
# –ó–Ω–∞—Ö–æ–¥–∏–º–æ —Ç–æ–ø-5 –Ω–∞–π–±—ñ–ª—å—à–∏—Ö –ø–æ–º–∏–ª–æ–∫ –¥–ª—è –æ–±–æ—Ö –º–æ–¥–µ–ª–µ–π
largest_errors_lr = errors_lr.nlargest(5)
largest_errors_xgb = errors_xgb.nlargest(5)

print("\n–¢–æ–ø-5 –Ω–∞–π–±—ñ–ª—å—à–∏—Ö –ø–æ–º–∏–ª–æ–∫ (–õ—ñ–Ω—ñ–π–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è):")
print(largest_errors_lr)

print("\n–¢–æ–ø-5 –Ω–∞–π–±—ñ–ª—å—à–∏—Ö –ø–æ–º–∏–ª–æ–∫ (–ì—Ä–∞–¥—ñ—î–Ω—Ç–Ω–∏–π –±—É—Å—Ç–∏–Ω–≥):")
print(largest_errors_xgb)
```

**–Ü–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—è**:
- –û–±–∏–¥–≤—ñ –º–æ–¥–µ–ª—ñ –º–∞—é—Ç—å –Ω–∞–π–±—ñ–ª—å—à—ñ –ø–æ–º–∏–ª–∫–∏ –¥–ª—è **–∞–Ω–æ–º–∞–ª—å–Ω–æ –≤–µ–ª–∏–∫–∏—Ö –∑–Ω–∞—á–µ–Ω—å –æ—Ä–µ–Ω–¥–∏** (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∑–Ω–∞—á–µ–Ω–Ω—è –æ—Ä–µ–Ω–¥–∏ –ø–æ–Ω–∞–¥ 1 –º—ñ–ª—å–π–æ–Ω).
- –õ—ñ–Ω—ñ–π–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î **–±—ñ–ª—å—à—ñ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è** –¥–ª—è –≤–∏—Å–æ–∫–∏—Ö –∑–Ω–∞—á–µ–Ω—å, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–æ–Ω–∞ –Ω–µ –≤—Ä–∞—Ö–æ–≤—É—î –Ω–µ–ª—ñ–Ω—ñ–π–Ω—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ.  
- –ì—Ä–∞–¥—ñ—î–Ω—Ç–Ω–∏–π –±—É—Å—Ç–∏–Ω–≥ –∫—Ä–∞—â–µ –ø—Ä–æ–≥–Ω–æ–∑—É—î —Å–µ—Ä–µ–¥–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è, –∞–ª–µ —Ç–∞–∫–æ–∂ –ø–æ–º–∏–ª—è—î—Ç—å—Å—è –¥–ª—è **–µ–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–∏—Ö –≤–∏–ø–∞–¥–∫—ñ–≤**.

---

### **4. –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è —è–∫–æ—Å—Ç—ñ –º–æ–¥–µ–ª–µ–π**

| –ú–æ–¥–µ–ª—å                 | \( R^2 \)   | MAE (—Ç–µ—Å—Ç) | –†–æ–∑–ø–æ–¥—ñ–ª –ø–æ–º–∏–ª–æ–∫            |
|------------------------|------------|------------|-----------------------------|
| **–õ—ñ–Ω—ñ–π–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è**   | 0.51       | 22842.34   | –®–∏—Ä–æ–∫–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª, –≤–µ–ª–∏–∫—ñ –ø–æ–º–∏–ª–∫–∏ |
| **–ì—Ä–∞–¥—ñ—î–Ω—Ç–Ω–∏–π –±—É—Å—Ç–∏–Ω–≥**| 0.28       | 15332.07   | –í—É–∂—á–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª, —Å—Ç–∞–±—ñ–ª—å–Ω—ñ –ø–æ–º–∏–ª–∫–∏ |

**–í–∏—Å–Ω–æ–≤–æ–∫**:  
- **–õ—ñ–Ω—ñ–π–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è** –º–∞—î **–≤–∏—â–∏–π \( R^2 \)**, –∞–ª–µ —á–µ—Ä–µ–∑ –≤–µ–ª–∏–∫—ñ –ø–æ–º–∏–ª–∫–∏ –≤–æ–Ω–∞ –Ω–µ—Å—Ç–∞–±—ñ–ª—å–Ω–∞ —Ç–∞ –Ω–µ—Ç–æ—á–Ω–∞.  
- **XGBoost** –º–∞—î **–Ω–∏–∂—á–∏–π \( R^2 \)**, –∞–ª–µ **–∫—Ä–∞—â–∏–π MAE** —ñ —Å—Ç–∞–±—ñ–ª—å–Ω—ñ—à–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª –ø–æ–º–∏–ª–æ–∫, —â–æ —Ä–æ–±–∏—Ç—å –π–æ–≥–æ –Ω–∞–¥—ñ–π–Ω—ñ—à–∏–º –¥–ª—è –±—ñ–ª—å—à–æ—Å—Ç—ñ —Ç–∏–ø–æ–≤–∏—Ö –∑–Ω–∞—á–µ–Ω—å –æ—Ä–µ–Ω–¥–∏.  

---

### **5. –ó–∞–≥–∞–ª—å–Ω—ñ –≤–∏—Å–Ω–æ–≤–∫–∏**

1. **–õ—ñ–Ω—ñ–π–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è**:
   - –î–µ–º–æ–Ω—Å—Ç—Ä—É—î **–±–∞–∑–æ–≤—É —Ç–æ—á–Ω—ñ—Å—Ç—å** –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è, –∞–ª–µ –Ω–µ –≤—Ä–∞—Ö–æ–≤—É—î –Ω–µ–ª—ñ–Ω—ñ–π–Ω—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ.  
   - –ú–∞—î –≤–µ–ª–∏–∫—ñ –ø–æ–º–∏–ª–∫–∏ –¥–ª—è **–∞–Ω–æ–º–∞–ª—å–Ω–æ –≤–∏—Å–æ–∫–∏—Ö –∑–Ω–∞—á–µ–Ω—å –æ—Ä–µ–Ω–¥–∏**.

2. **–ì—Ä–∞–¥—ñ—î–Ω—Ç–Ω–∏–π –±—É—Å—Ç–∏–Ω–≥ (XGBoost)**:
   - –ü–æ–∫–∞–∑—É—î **–º–µ–Ω—à—ñ –ø–æ–º–∏–ª–∫–∏** —Ç–∞ —Å—Ç–∞–±—ñ–ª—å–Ω—ñ—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è —Ç–∏–ø–æ–≤–∏—Ö –∑–Ω–∞—á–µ–Ω—å.  
   - –ü–æ—Ç—Ä–µ–±—É—î –¥–æ–¥–∞—Ç–∫–æ–≤–æ–≥–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≥—ñ–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –¥–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è —Ç–æ—á–Ω–æ—Å—Ç—ñ.

3. **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó –¥–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è**:
   - –û–±—Ä–æ–±–∏—Ç–∏ **–∞–Ω–æ–º–∞–ª—å–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è** –æ—Ä–µ–Ω–¥–∏ —É –¥–∞–Ω–∏—Ö.  
   - –î–æ–¥–∞—Ç–∏ –Ω–æ–≤—ñ –æ–∑–Ω–∞–∫–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –≥–µ–æ–≥—Ä–∞—Ñ—ñ—á–Ω—ñ –¥–∞–Ω—ñ –∞–±–æ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó).  
   - –û–ø—Ç–∏–º—ñ–∑—É–≤–∞—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ XGBoost –¥–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ.  

**–ó–∞–≥–∞–ª—å–Ω–∏–π –≤–∏—Å–Ω–æ–≤–æ–∫**: –ì—Ä–∞–¥—ñ—î–Ω—Ç–Ω–∏–π –±—É—Å—Ç–∏–Ω–≥ —î **–∫—Ä–∞—â–∏–º –≤–∏–±–æ—Ä–æ–º** –¥–ª—è —Å—Ç–∞–±—ñ–ª—å–Ω–æ–≥–æ –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è, –∞–ª–µ –º–æ–¥–µ–ª—å –ø–æ—Ç—Ä–µ–±—É—î –ø–æ–¥–∞–ª—å—à–æ—ó –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó —Ç–∞ –æ–±—Ä–æ–±–∫–∏ –¥–∞–Ω–∏—Ö –¥–ª—è –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è –±—ñ–ª—å—à–æ—ó —Ç–æ—á–Ω–æ—Å—Ç—ñ.

### –ü–æ–∫—Ä–∞—â–∏—Ç–∏ –º–æ–¥–µ–ª—å –ì—Ä–∞–¥—ñ—î–Ω—Ç–Ω–æ–≥–æ –±—É—Å—Ç–∏–Ω–≥—É (XGBoost), –ø—Ä–æ–≤–µ–¥–µ–º–æ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏ –∑ –ø–µ—Ä–µ–¥–æ–±—Ä–æ–±–∫–æ—é –¥–∞–Ω–∏—Ö.

–û—Å–Ω–æ–≤–Ω–∞ —É–≤–∞–≥–∞ –±—É–¥–µ –Ω–∞:

- –í–∏–¥–∞–ª–µ–Ω–Ω—ñ –∞–Ω–æ–º–∞–ª—å–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å –¥–ª—è —Ü—ñ–ª—å–æ–≤–æ—ó –∑–º—ñ–Ω–Ω–æ—ó Rent.
- –ú–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—ñ —á–∏—Å–ª–æ–≤–∏—Ö –æ–∑–Ω–∞–∫ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, Size, BHK).
- –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó –∫–∞—Ç–µ–≥–æ—Ä—ñ–∞–ª—å–Ω–∏—Ö –æ–∑–Ω–∞–∫ —á–µ—Ä–µ–∑ Label Encoding –¥–ª—è XGBoost.
"""

from sklearn.preprocessing import StandardScaler, LabelEncoder
import matplotlib.pyplot as plt

# –í–∏–¥–∞–ª–µ–Ω–Ω—è –∞–Ω–æ–º–∞–ª—å–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å –¥–ª—è Rent
q1 = data_cleaned['Rent'].quantile(0.01)
q3 = data_cleaned['Rent'].quantile(0.99)
data_filtered = data_cleaned[(data_cleaned['Rent'] >= q1) & (data_cleaned['Rent'] <= q3)].copy()

# –û–±—Ä–æ–±–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ–∞–ª—å–Ω–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö (Label Encoding –¥–ª—è XGBoost)
label_encoders = {}
categorical_features = ['City_Mumbai', 'City_Chennai', 'Furnishing Status_Unfurnished', 'Area Type_Super Area']

for col in categorical_features:
    le = LabelEncoder()
    data_filtered[f"{col}_encoded"] = le.fit_transform(data_filtered[col])  # –°—Ç–≤–æ—Ä—é—î–º–æ –Ω–æ–≤–∏–π —Å—Ç–æ–≤–ø–µ—Ü—å
    label_encoders[col] = le

# –ú–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è —á–∏—Å–ª–æ–≤–∏—Ö –æ–∑–Ω–∞–∫
scaler = StandardScaler()
numerical_features = ['BHK', 'Size', 'Bathroom']

# –ú–∞—Å—à—Ç–∞–±—É—î–º–æ —á–∏—Å–ª–æ–≤—ñ –æ–∑–Ω–∞–∫–∏ —ñ —Å—Ç–≤–æ—Ä—é—î–º–æ –Ω–æ–≤—ñ —Å—Ç–æ–≤–ø—Ü—ñ
scaled_values = scaler.fit_transform(data_filtered[numerical_features])
for i, col in enumerate(numerical_features):
    data_filtered[f"{col}_scaled"] = scaled_values[:, i]

# –í–∏–¥–∞–ª—è—î–º–æ —Å—Ç–∞—Ä—ñ —Å—Ç–æ–≤–ø—Ü—ñ —Ç–∞ —Ñ–æ—Ä–º—É—î–º–æ –Ω–æ–≤–∏–π X —ñ y
final_features = [f"{col}_encoded" for col in categorical_features] + [f"{col}_scaled" for col in numerical_features]
X = data_filtered[final_features]
y = data_filtered['Rent']

# –†–æ–∑–ø–æ–¥—ñ–ª –Ω–∞ —Ç—Ä–µ–Ω—É–≤–∞–ª—å–Ω—É —ñ —Ç–µ—Å—Ç–æ–≤—É –≤–∏–±—ñ—Ä–∫—É
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# –¢—Ä–µ–Ω—É–≤–∞–Ω–Ω—è XGBoost
model_xgb = XGBRegressor(
    n_estimators=200,
    learning_rate=0.05,
    max_depth=6,
    subsample=0.8,
    colsample_bytree=0.8,
    random_state=42
)

model_xgb.fit(X_train, y_train)
y_pred_xgb = model_xgb.predict(X_test)

# –û—Ü—ñ–Ω–∫–∞ —è–∫–æ—Å—Ç—ñ
r2_xgb = r2_score(y_test, y_pred_xgb)
mae_xgb = mean_absolute_error(y_test, y_pred_xgb)

print(f"–ì—Ä–∞–¥—ñ—î–Ω—Ç–Ω–∏–π –±—É—Å—Ç–∏–Ω–≥ –ø—ñ—Å–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è: R¬≤ = {r2_xgb:.2f}, MAE = {mae_xgb:.2f}")

# –ü–æ–±—É–¥–æ–≤–∞ –≥—Ä–∞—Ñ—ñ–∫–∞ —Ñ–∞–∫—Ç–∏—á–Ω–∏—Ö —Ç–∞ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å
plt.figure(figsize=(10, 6))
plt.scatter(y_test, y_pred_xgb, alpha=0.5, color='b', label='–ü—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è')
plt.plot([y_test.min(), y_test.max()], [y_test.min(), y_test.max()], 'r--', lw=2, label='–Ü–¥–µ–∞–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å')
plt.xlabel('–§–∞–∫—Ç–∏—á–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –æ—Ä–µ–Ω–¥–Ω–æ—ó –ø–ª–∞—Ç–∏')
plt.ylabel('–ü—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –æ—Ä–µ–Ω–¥–Ω–æ—ó –ø–ª–∞—Ç–∏')
plt.title('–ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è —Ñ–∞–∫—Ç–∏—á–Ω–∏—Ö —Ç–∞ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å –æ—Ä–µ–Ω–¥–Ω–æ—ó –ø–ª–∞—Ç–∏')
plt.legend()
plt.grid(True)
plt.show()